/*
Auto-generated by: https://github.com/pmndrs/gltfjsx
*/

import * as THREE from "three";
import {Vector3} from "three";
import React, { useRef, useState, useEffect } from 'react'
import {useAnimations, useGLTF, SpotLight} from '@react-three/drei'
import {useFrame, useThree} from "@react-three/fiber";

export default function Model(props) {
    const group = useRef()
    const { nodes, materials, animations } = useGLTF('./b12.gltf')

    //Animation setting
    const { actions, mixer  } = useAnimations(animations, group)
    useEffect(() => {
        for (const anim in actions) {
            actions[anim].setLoop(THREE.LoopOnce)
        }

    }, [mixer]);
    const { scene } = useThree();
    let targetObj = scene.getObjectByName("targetObject")
    let oldObjX = 8.35
    let oldObjY = 3.56
    let oldObjZ = -2.44
    useFrame((state) => {

        targetObj.visible = false
        targetObj.position.x = oldObjX - -state.mouse.x
        targetObj.position.z = oldObjZ -  -state.mouse.x*2
        targetObj.position.y = oldObjY - -state.mouse.y
    })


    return (

        // <group {...props} dispose={null}>
        //     <group rotation={[0, 0, 0]} scale={30} >
        //         <group rotation={[0, 0, 0]}>
        //             <mesh geometry={nodes.Object_0.geometry} material={materials.M_Drone} />
        //             <mesh geometry={nodes.Object_0_1.geometry} material={materials.M_eye_drone_Inst} />
        //             <spotLight castShadow  intensity={props.Light} angle={0.2} penumbra={1} decay={2} position={[0, 0, -.01]} rotation={[Math.PI, 0, 0]} scale={0.09} />
        //         </group>
        //     </group>
        // </group>
        <group ref={group} {...props} dispose={null} position={[-1, 1.08, -3.05]}>
            <group name="Scene">
                <group name="B12"  rotation={[-Math.PI / 2, 0, -Math.PI]} scale={4}>
                    <group name="root">
                        <group name="GLTF_SceneRootNode" rotation={[Math.PI / 2, -Math.PI / 2, 0]}>
                            <group name="Drone_StaticMesh_0">
                                <group name="Object_4">
                                    <mesh name="Object_0" target={targetObj} castShadow receiveShadow geometry={nodes.Object_0.geometry} material={materials.M_Drone} />
                                    <mesh name="Object_0_1"target={targetObj}  castShadow receiveShadow geometry={nodes.Object_0_1.geometry} material={materials.M_eye_drone_Inst} />
                                    <SpotLight name="Spot"  castShadow target={targetObj} distance={40} angle={0.35}  anglePower={5} attenuation={props.Light} intensity={props.Light} penumbra={1} decay={2} position={[0, 0.01, 0.04]} rotation={[Math.PI, 0, 0]} scale={0.09}>
                                        <group position={[0, 0, -1]} />
                                    </SpotLight>
                                </group>
                            </group>
                        </group>
                    </group>
                </group>
            </group>
        </group>
    )
}


useGLTF.preload('./b12.gltf')
