/*
Auto-generated by: https://github.com/pmndrs/gltfjsx
*/

import * as THREE from "three";
import React, { useRef, useEffect } from 'react'
import {useAnimations, useGLTF} from '@react-three/drei'
import {useFrame, useThree} from "react-three-fiber";

export default function Model(props) {
    const group = useRef()
    const refB12 = useRef()
    const { nodes, materials, animations } = useGLTF('../../../../b12.gltf')

    useEffect(() => {
        if (window.innerWidth > 768) {
            document.getElementById("CanvasSection").addEventListener("mousemove", MouseMove);
        }
        return () => {
            document.getElementById("CanvasSection").removeEventListener("mousemove", MouseMove);
        }
    }, []);
    function MouseMove(e) {
        refB12.current.rotation.x =  -.15 + e.clientY / window.innerHeight/2
        refB12.current.rotation.y =  e.clientX / window.innerWidth
        refB12.current.rotation.z = -.15 + -e.clientY / window.innerWidth/2

            // e.clientX / window.innerWidth

    }
    //Animation setting
    const { actions, mixer  } = useAnimations(animations, group)
    useEffect(() => {
        for (const anim in actions) {
            actions[anim].setLoop(THREE.LoopOnce)
        }

    }, [mixer]);


    return (
        <group ref={group} {...props} dispose={null} rotation={[0.,-1.25,.25]} position={[1, -.1, -2.5]}>
            <group name="Scene">
                <group scale={8}>
                    <group name="root">
                        <group name="GLTF_SceneRootNode">
                            <group name="Drone_StaticMesh_0">
                                <group name="B12" ref={refB12}>
                                    <mesh name="Object_0" castShadow receiveShadow geometry={nodes.Object_0.geometry} material={materials.M_Drone} />
                                    <mesh name="Object_0_1"  receiveShadow geometry={nodes.Object_0_1.geometry} material={materials.M_eye_drone_Inst} />
                                </group>
                                <spotLight  intensity={1.9}  position={[1, 1, 0]} penumbra={1}/>
                                {/*<spotLight castShadow intensity={1.9} position={[-1, 1, 0]} penumbra={1}/>*/}
                            </group>
                        </group>
                    </group>
                </group>
            </group>
        </group>
    )

}


useGLTF.preload('../../../../b12.gltf')
